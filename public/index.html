<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="GraphQL Study API Interface - Manage users and notes">
    <title>GraphQL Study API Interface</title>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-project-diagram"></i> GraphQL Study API</h1>
            <p class="subtitle">Manage users and notes with a modern GraphQL interface</p>
        </header>
        
        <div class="data-grids">
            <div class="grid-section">
                <div class="section-header">
                    <h2>Users</h2>
                    <button onclick="fetchUsers()" class="refresh-btn" title="Refresh users">
                        <i class="fas fa-sync-alt"></i>
                    </button>
                </div>
                <div id="usersGrid" class="grid-container">
                    <!-- Users will be inserted here -->
                </div>
            </div>
            
            <div class="grid-section">
                <div class="section-header">
                    <h2>Notes</h2>
                    <button onclick="fetchNotes()" class="refresh-btn" title="Refresh notes">
                        <i class="fas fa-sync-alt"></i>
                    </button>
                </div>
                <div id="notesGrid" class="grid-container">
                    <!-- Notes will be inserted here -->
                </div>
            </div>
        </div>
        
        <div class="section">
            <h2><i class="fas fa-user-plus"></i> Create User</h2>
            <form id="createUserForm" onsubmit="event.preventDefault(); createUser();">
                <div class="form-group">
                    <label for="username">Username:</label>
                    <input type="text" id="username" class="form-control" placeholder="Enter username" required>
                </div>
                <div class="form-group">
                    <label for="email">Email:</label>
                    <input type="email" id="email" class="form-control" placeholder="Enter email" required>
                </div>
                <div class="form-group">
                    <label for="password">Password:</label>
                    <input type="password" id="password" class="form-control" placeholder="Enter password" required>
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-user-plus"></i> Create User
                    </button>
                </div>
            </form>
        </div>

        <div class="section">
            <h2><i class="fas fa-sticky-note"></i> Create Note</h2>
            <form id="createNoteForm" onsubmit="event.preventDefault(); createNote();">
                <div class="form-group">
                    <label for="noteAuthor">Author:</label>
                    <select id="noteAuthor" name="authorId" required class="form-control">
                        <option value="" disabled selected>Select an author</option>
                        <!-- Authors will be populated by JavaScript -->
                    </select>
                </div>
                <div class="form-group">
                    <label for="noteTitle">Title:</label>
                    <input type="text" id="noteTitle" class="form-control" placeholder="Enter note title" required>
                </div>
                <div class="form-group">
                    <label for="noteContent">Content:</label>
                    <textarea id="noteContent" class="form-control" rows="4" placeholder="Enter note content" required></textarea>
                </div>
                <div class="form-group">
                    <label for="noteTags">Tags (comma-separated):</label>
                    <input type="text" id="noteTags" class="form-control" placeholder="tag1, tag2, tag3">
                    <small class="form-text">Separate multiple tags with commas</small>
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-plus"></i> Create Note
                    </button>
                </div>
            </form>
        </div>

        <div class="section">
            <h2><i class="fas fa-search"></i> Search & Filter</h2>
            <div class="form-group">
                <div class="button-group">
                    <button onclick="fetchUsers()" class="btn">
                        <i class="fas fa-users"></i> Load Users
                    </button>
                    <button onclick="fetchNotes()" class="btn">
                        <i class="fas fa-sticky-note"></i> Load Notes
                    </button>
                </div>
            </div>
            <form id="searchForm" onsubmit="event.preventDefault(); searchByTag();">
                <div class="form-group">
                    <label for="searchTag">Search by Tag:</label>
                    <div class="search-container">
                        <input type="text" id="searchTag" class="form-control" placeholder="Enter tag to search">
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-search"></i> Search
                        </button>
                    </div>
                </div>
            </form>
        </div>

        <div class="section">
            <h2><i class="fas fa-edit"></i> Update Note</h2>
            <form id="updateNoteForm" onsubmit="event.preventDefault(); updateNote();">
                <div class="form-group">
                    <label for="updateNoteId">Note ID:</label>
                    <input type="text" id="updateNoteId" class="form-control" placeholder="Enter note ID" required>
                </div>
                <div class="form-group">
                    <label for="updateTitle">New Title (optional):</label>
                    <input type="text" id="updateTitle" class="form-control" placeholder="Enter new title">
                </div>
                <div class="form-group">
                    <label for="updateContent">New Content (optional):</label>
                    <textarea id="updateContent" class="form-control" rows="3" placeholder="Enter new content"></textarea>
                </div>
                <div class="form-group">
                    <label for="updateTags">New Tags (comma-separated):</label>
                    <input type="text" id="updateTags" class="form-control" placeholder="tag1, tag2, tag3">
                    <small class="form-text">Leave empty to keep existing tags</small>
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save"></i> Update Note
                    </button>
                </div>
            </form>
        </div>

        <div class="section">
            <h2><i class="fas fa-trash-alt"></i> Delete Note</h2>
            <form id="deleteNoteForm" onsubmit="event.preventDefault(); deleteNote();">
                <div class="form-group">
                    <label for="deleteNoteId">Note ID:</label>
                    <div class="input-with-button">
                        <input type="text" id="deleteNoteId" class="form-control" placeholder="Enter note ID to delete" required>
                        <button type="submit" class="btn btn-danger">
                            <i class="fas fa-trash"></i> Delete
                        </button>
                    </div>
                </div>
            </form>
        </div>

        <div id="response" class="response"></div>
        
        <footer class="footer">
            <p>GraphQL Study API &copy; 2023 | Built with Node.js, Express, Apollo Server & MongoDB</p>
        </footer>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="/js/script.js"></script>
    <script>
        // Initialize the app when the DOM is fully loaded
        document.addEventListener('DOMContentLoaded', function() {
            // Load initial data
            fetchUsers();
            fetchNotes();
            
            // Set up refresh buttons
            document.querySelectorAll('.refresh-btn').forEach(btn => {
                const gridId = btn.closest('.grid-section').querySelector('.grid-container').id;
                btn.addEventListener('click', () => {
                    if (gridId === 'usersGrid') fetchUsers();
                    if (gridId === 'notesGrid') fetchNotes();
                });
            });
        });
    </script>
</body>
</html>
